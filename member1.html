<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <!-- jquery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <title>차준호 - V8 팀원</title>
    <style>
      body {
        font-family: sans-serif;
      }
      /*메인과 글꼴 통일*/
      .header_section {
        background-color: #0f172a;
        padding: 1rem;
        text-align: center;
      }

      .header_name {
        font-size: 60px;
        font-weight: bold;
        color: white;
        text-decoration: none;
      }
      /*헤더 배경, 글꼴 지정*/
      .comment {
        font-weight: bold;
        border-bottom: 1px solid #dee2e6;
        padding-bottom: 8px;
      }

      .person_image {
        max-width: 100%;
        height: 100%;
        border-radius: 4px;
      }
      /*img파일 크기 카드에 맞춤*/
    </style>
    <script type="module">
      // Firebase
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
      import { getFirestore } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
      import {
        collection,
        addDoc,
      } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
      import { getDocs } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyBUuA-bppz3--8IMOryo1p7QgOBbMfgS6s",
        authDomain: "sparta-v8.firebaseapp.com",
        projectId: "sparta-v8",
        storageBucket: "sparta-v8.firebasestorage.app",
        messagingSenderId: "641530961251",
        appId: "1:641530961251:web:25b86f361fdae002f68756",
      };

      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      // 열고 닫기
      $("#openclose").click(async function () {
        $("#commentbox").toggle();
        const btn = document.getElementById("openclose");
        const isVisible = $("#commentbox").is(":visible");
        btn.textContent = isVisible ? "닫기" : "댓글작성하기";
      });

      // 댓글 DB 저장
      $("#makeComment").click(async function () {
        let name = $("#name").val();
        let comment = $("#comment").val();

        let doc = {
          name: name,
          comment: comment,
        };
        // 개인별 댓글 DB
        await addDoc(collection(db, "comment"), doc);
        alert("저장 완료!");
        window.location.reload();
      });

      // 댓글 DB 불러오기
      // 개인별 댓글 DB
      let docs = await getDocs(collection(db, "comment"));
      docs.forEach((doc) => {
        let row = doc.data();

        let name = row["name"];
        let comment = row["comment"];

        let temp_html = `
            <div class="border p-3 mb-2">
                <p class="mb-1"><strong>이름:</strong> ${name}</p>
                <p class="mb-0"><strong>내용:</strong> ${comment}</p>
            </div>`;

        $("#comment-area").append(temp_html);
      });
    </script>
  </head>

  <body class="bg-light">
    <header class="header_section">
      <a href="mainscreen.html" class="header_name">V8 팀으로 돌아가기</a>
    </header>

    <main class="container my-5">
      <div class="row justify-content-center">
        <div class="col-md-8">
          <div class="card shadow rounded-3">
            <div class="row g-0">
              <div class="col-md-4">
                <img
                  src="image/차준호.png"
                  class="person_image"
                  alt="차준호 사진"
                />
              </div>
              <div class="col-md-8">
                <div class="card-body">
                  <h4 class="card-title fw-bold">차준호</h4>
                  <p class="card-text">
                    전공자는 아니지만 열심히 참여해서 많이 얻어가겠습니다!
                  </p>
                  <ul class="list-unstyled">
                    <li><strong>생일:</strong> 2000.00.00</li>
                    <li><strong>MBTI:</strong> INTJ</li>
                    <li>
                      <strong>블로그 주소:</strong>
                      <a href="https://juno0112.tistory.com/" target="_blank"
                        >https://juno0112.tistory.com/</a
                      >
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>

          <!-- 댓글 섹션 -->
          <section class="mt-5">
            <h5 class="comment">댓글</h5>
            <button class="btn btn-outline-primary mb-4" id="openclose">
              댓글작성하기
            </button>
            <div id="commentbox" style="display: none">
              <div class="mb-3">
                <label for="commentName" class="name">이름</label>
                <input
                  type="text"
                  class="form-control"
                  id="name"
                  placeholder="이름을 입력하세요"
                />
              </div>
              <div class="mb-3">
                <label for="commentContent" class="content">내용</label>
                <textarea
                  class="form-control"
                  id="comment"
                  rows="3"
                  placeholder="내용을 입력하세요"
                ></textarea>
              </div>
              <button class="btn btn-outline-primary mb-4" id="makeComment">
                댓글작성
              </button>
            </div>

            <div id="comment-area"></div>
          </section>
        </div>
      </div>
    </main>
  </body>
</html>
